{% extends 'base_layout.html.twig' %}

{% block title %}{{ thread.name|e }}{% endblock %}

{% block body %}
    <div class="container bg-light">
        <div class="row">
            {{ thread.name|e }}
            {{ thread.creationTime|date('Y/m/d H:m:s') }}
            author: {{ (thread.author is not empty) ? thread.author|e : 'anonymous' }}
        </div>
        <p>
{#            <img src="{{ thread.pictureName|e }}">#}
            {{ thread.text|e }}
        </p>
    </div>

    {% for message in messages %}
        <div id="{{ message.id }}" class="container bg-light mt-1">
            <div class="row">
                <strong>#{{ message.id }}</strong>
                &nbsp
                {{ message.time|date('Y/m/d H:m:s') }}
{#                    TODO change author_id on login #}
                author: {{ (message.author_id is not empty) ? thread.author_id|e : 'anonymous' }}
                &nbsp
                &nbsp
                <a href="#{{ message.id }}" class="answerLink" >answer</a>
            </div>
            {% for link in message.parent_massages|split(' ') %}
                {% set xssSecureLink = link|e %}
                {% if xssSecureLink is not empty %}
                <a class="board-message" href="#{{ xssSecureLink }}">>>>>>{{ link|e }}</a>
                {% endif %}
            {% endfor %}
            <p>
{#                {{ message.text|e }}  //<b> <s> tags is allowed #}
                {{ message.text|striptags('<b>,<s>')| raw }}
            </p>
            {% for link in message.child_massages|split(' ') %}
                {% set xssSecureLink = link|e %}
                {% if xssSecureLink is not empty %}
                <a class="board-message" href="#{{ xssSecureLink }}">>>>>>{{ xssSecureLink }}</a>
                {% endif %}
            {% endfor %}
            <div class="pop-up"></div>
        </div>
    {% endfor %}
    <hr>
    <h6>Add new message</h6>
    {{ form(message_form) }}
{% endblock %}
